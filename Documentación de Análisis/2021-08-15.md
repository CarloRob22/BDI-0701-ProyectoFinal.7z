@author roberto.duran@unah.hn, mruizq@unah.hn, fernando.murillo@unah.hn, yesenia.espinoza@unah.hn
@version 0.1.0

@date 2021/08/15

Documentación de Análisis
===

Elimacion de un usuario en el CRUD del modulo administrador
----
----

Restriciones en llaves foraneas
----
MySQL admite llaves foraneas, que permiten la referencia cruzada de datos relacionados entre tablas, y restricciones de llaves foraneas, que ayudan a mantener la coherencia de los datos relacionados.

Una relación de llave foranea implica una tabla padre que contiene los valores de la columna inicial y una tabla hija con valores de columna que hacen referencia a los valores de la columna de la tabla padre. 
- Se define una restricción de llave foranea en la tabla hija.

<br>
Eliminacion o actualizacion de tuplas en tabla con restriccion referencial CONSTRAINT
----
Cuando una operación UPDATE o DELETE afecta a un valor clave en la tabla padre que tiene filas coincidentes en la tabla hija, el resultado depende de la acción referencial especificada por las subcláusulas ON UPDATE y ON DELETE de la cláusula FOREIGN KEY.

<br>
CASCADE
----
Elimina o actualiza la fila de la tabla padre y elimina o actualiza automáticamente las filas coincidentes en la tabla hija. Se admiten tanto ON DELETE CASCADE como ON UPDATE CASCADE. Entre dos tablas.

<br>
Problema
----
- Teniendo en cuenta que las acciones de clave foranea en cascada no activan desencadenantes o Triggers, se plantea una forma de realizar una eliminacion en cascada manual haciendo uso de tecnicas, teoria, temas, nomenclatura y conocimientos adquiridos en clases, con el fin de garantizar la activacion del trigger al eliminar un usuario en el modulo administrador, para que dicha accion se registre en la bitacora.

<br>
Analisis de Solucion
----
- Para eliminar un Usuario se debe eliminar todo registro de tablas foraneas que hagan referencia a dicho usuario.
    - Las tablas que hacen referencia a un usuario pueden ser:
        - Tabla de Bitacora.
        - Tabla de Partida.
- Para eliminar un registro de Bitacora se debe eliminar todo registro de tablas foraneas que hagan referencia a dicho registro.
    - No existen Tablas en el modelo relacional cuyas tuplas hagan referencia a un registro de Bitacora.
- Para eliminar un registro de Partida se debe eliminar todo registro de tablas foraneas que hagan referencia a dicha partida.
    - Las tablas que pueden hacer referencia a una Partida son:
        - Tabla de Puntaje
        - Tabla de Movimiento
- Para eliminar un registro de Puntaje se debe eliminar todo registro de tablas foraneas que hagan referencia a dicho puntaje.
    - No existen Tablas en el modelo relacional cuyas tuplas hagan referencia a un registro de Puntaje.
- Para eliminar un registro de Movimiento se debe eliminar todo registro de tablas foraneas que hagan referencia a dicho movimiento.
    - No existen Tablas en el modelo relacional cuyas tuplas hagan referencia a un registro de Movimento.

<br>
Implementacion
----
Una opcion para resolver la problematica es la de implementar un procedimiento almacenado que se encarga de verificar la existencia de cada registro relacionado con el usuario a eliminar. En este caso se debe verificar los registros en las tablas Bitacora, Partida, Puntaje y Movimiento de forma que en caso de encontrar registros relacionados con el usuario estos se deben eliminar en un orden especifico antes de eliminar al usuario.

<br>
Pasos
----
- En el procedimiento almacenado se utiliza un cursor que recorre cada partida creada por el usuario.
- El cursor toma el id de cada partida y lo utiliza para borrar los puntajes y movimientos relacionados a dicho id.
- Luego se eliminan todas las partidas relacionadas con el usuario.
- Despues se elimina cada registro relaciona al usuario de la tabla bitacora.
- Finalmente se elimina el usuario.
